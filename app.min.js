var f;
(function(e){var c=function(){function d(b){this.ub={};this.hb=this.vb=0;this.w=document.getElementById(b);this.Ib=this.w.getContext("2d");this.rb=window.requestAnimationFrame.bind(window,this.Yb.bind(this))}d.prototype.Fb=function(){var b=new k;this.ub.demo=b};d.prototype.Play=function(b){if(this.Ga=this.ub[b])this.Ga.U(this),this.rb();else throw Error();};d.prototype.Yb=function(b){var a=b-this.hb;50<a&&(a=50);this.vb=a/1E3;this.Ga.s(this.vb);this.Ga.D(this.Ib);this.hb=b;this.rb()};return d}();e.l=
c})(f||(f={}));(function(e){var c=function(){function d(b){this.l=b}d.prototype.Qa=function(b,a){this.l.w.addEventListener("mousemove",this.ba.bind(null,b.bind(a)))};d.prototype.Pa=function(b,a){this.l.w.addEventListener("mousedown",this.ba.bind(null,b.bind(a)))};d.prototype.Ra=function(b,a){this.l.w.addEventListener("mouseup",this.ba.bind(null,b.bind(a)))};d.prototype.ba=function(b,a){b(a.layerX,a.layerY)};return d}();e.Vb=c})(f||(f={}));
(function(e){var c=function(){function d(b){this.l=b}d.prototype.Qa=function(b,a){this.l.w.addEventListener("touchmove",this.ba.bind(this,b.bind(a)))};d.prototype.Pa=function(b,a){this.l.w.addEventListener("touchstart",this.ba.bind(this,b.bind(a)))};d.prototype.Ra=function(b,a){this.l.w.addEventListener("touchend",function(){b.call(a,0,0)})};d.prototype.ba=function(b,a){b(a.targetTouches[0].pageX,a.targetTouches[0].pageY);a.preventDefault()};return d}();e.ic=c})(f||(f={}));
(function(e){var c=function(){function d(b,a){void 0===b&&(b=0);void 0===a&&(a=0);this.x=b;this.y=a}d.prototype.Set=function(b,a){this.x=b;this.y=a};d.prototype.J=function(){return new d(this.x,this.y)};return d}();e.Va=c})(f||(f={}));
(function(e){(function(c){function d(a,b){void 0===a&&(a=0);void 0===b&&(b=0);return new e.Va(a,b)}function b(a,b){if(b)b.x=a.x,b.y=a.y;else return d(a.x,a.y)}function a(a){return Math.sqrt(a.x*a.x+a.y*a.y)}c.nc=new e.Va;c.ma=new e.Va;c.m=d;c.J=b;c.Rb=function(a){return 0===a.x&&0===a.y};c.oa=function(a,b,d){d.x=a.x+b.x;d.y=a.y+b.y};c.ga=function(a,b,d){d.x=a.x-b.x;d.y=a.y-b.y};c.jb=function(a,b,d){d.x=a.x*b.x;d.y=a.y*b.y};c.g=function(a,b,d){void 0===d&&(d=a);d.x=a.x*b;d.y=a.y*b};c.Ja=a;c.wb=function(b){var d;
void 0===d&&(d=b);var c=a(b);0<c&&(d.x=b.x/c,d.y=b.y/c)};c.sb=function(a,d,c){void 0===c&&(c=a);var h=Math.sin(d);d=Math.cos(d);a===c&&(a=b(a));c.x=a.x*d-a.y*h;c.y=a.x*h+a.y*d};c.Ya=function(a){return Math.atan2(a.y,a.x)};c.Ob=function(a,b){b.x=0<a.x?1/a.x:0;b.y=0<a.y?1/a.y:0}})(e.f||(e.f={}))})(f||(f={}));var m=this&&this.oc||function(e,c){function d(){this.constructor=e}for(var b in c)c.hasOwnProperty(b)&&(e[b]=c[b]);d.prototype=c.prototype;e.prototype=new d};
(function(e){var c=function(){function d(b,a,d,c){this.b=e.f.m(b,a);this.a=e.f.m(d,c);this.v=e.f.m(0,0);this.g=e.f.m(1,1);this.da=0;this.$=1}d.prototype.D=function(b){b.save();b.globalAlpha*=this.$;b.translate(this.b.x,this.b.y);b.scale(this.g.x,this.g.y);b.rotate(this.da);e.f.Rb(this.v)||b.translate(-this.v.x*this.a.x,-this.v.y*this.a.y);this.X(b);b.restore()};d.prototype.X=function(){throw Error("Unimplemented");};d.prototype.Ca=function(b,a){var d,c=e.f.ma;a?(e.f.J(b,a),d=a):d=e.f.J(b);this.ca&&
this.ca.Ca(b,d);e.f.ga(d,this.b,d);e.f.J(this.g,c);e.f.Ob(c,c);e.f.jb(d,c,d);e.f.sb(d,-this.da,d);e.f.J(this.v,c);e.f.jb(c,this.a,c);e.f.oa(d,c,d);if(!a)return d};d.prototype.Qb=function(b){b=this.Ca(b);var a=0<b.y&&b.y<this.a.y;return 0<b.x&&b.x<this.a.x&&a};d.prototype.qb=function(){this.ca.ya(this)};return d}();e.Ha=c;c=function(d){function b(){d.apply(this,arguments);this.qa=[]}m(b,d);b.prototype.Y=function(a){if(a.ca)throw Error("Child has parent");a.ca=this;this.qa.push(a)};b.prototype.ya=function(a){var b=
this.qa.indexOf(a);if(0<=b)a.ca=void 0,this.qa.splice(b,1);else throw Error("Child doesn't exist in this layer");};b.prototype.X=function(a){for(var b=0,d=this.qa;b<d.length;b++)d[b].D(a)};return b}(c);e.ib=c})(f||(f={}));var n;
(function(e){var c=function(d){function b(a,b,c,e,h){void 0===h&&(h={fillStyle:"red"});d.call(this,a,b,c,e);this.i=h}m(b,d);b.prototype.X=function(a){this.i.fillStyle&&(a.fillStyle=this.i.fillStyle,a.fillRect(0,0,this.a.x,this.a.y));this.i.strokeStyle&&(a.strokeStyle=this.i.strokeStyle,a.strokeRect(0,0,this.a.x,this.a.y))};return b}(f.Ha);e.pb=c})(n||(n={}));
(function(e){var c=function(){function d(b,a,d){void 0===d&&(d="white");this.N=b;this.a=a;this.M=d;this.Za={};this.B=a/b.Z.Ia;this.W=b.Z.Ea*this.B;this.Cache=document.createElement("canvas");this.Cache.width=Object.keys(b.Ka).length*Math.ceil(this.W+this.B);this.Cache.height=a;console.log("FontCache Size",this.a,"DotPx",this.B,"Color",this.M);this.ac()}d.prototype.cb=function(b,a,d,c,e,h){void 0===d&&(d=0);void 0===c&&(c=0);void 0===e&&(e=1);void 0===h&&(h=e);b.drawImage(this.Cache,this.Za[a],0,this.W,
this.a,d,c,this.W*e,this.a*h)};d.prototype.ac=function(){var b=this.Cache.getContext("2d"),a=0;b.fillStyle=this.M;for(var d in this.N.Ka){this.bc(b,d);this.Za[d]=a;var c=Math.ceil(this.W+this.B),a=a+c;b.translate(c,0)}};d.prototype.bc=function(b,a){for(var d=this.N,c=this.B,e=0;e<d.Z.Ea;++e)for(var h=0;h<d.Z.Ia;++h)d.Ka[a][h*d.Z.Ea+e]&&b.fillRect(e*c,h*c,c,c)};return d}();e.Kb=c})(n||(n={}));
(n||(n={})).Zb={Z:{Ea:3,Ia:5},Ka:{"+":[0,0,0,0,1,0,1,1,1,0,1,0,0,0,0],"-":[0,0,0,0,0,0,1,1,1,0,0,0,0,0,0],".":[0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],":":[0,0,0,0,1,0,0,0,0,0,1,0,0,0,0],0:[1,1,1,1,0,1,1,0,1,1,0,1,1,1,1],1:[0,1,0,1,1,0,0,1,0,0,1,0,0,1,0],2:[1,1,1,0,0,1,1,1,1,1,0,0,1,1,1],3:[1,1,1,0,0,1,0,1,1,0,0,1,1,1,1],4:[1,0,1,1,0,1,1,1,1,0,0,1,0,0,1],5:[1,1,1,1,0,0,1,1,1,0,0,1,1,1,0],6:[0,1,1,1,0,0,1,1,1,1,0,1,1,1,1],7:[1,1,1,0,0,1,0,1,0,0,1,0,0,1,0],8:[1,1,1,1,0,1,1,1,1,1,0,1,1,1,1],9:[1,1,1,1,0,1,1,
1,1,0,0,1,1,1,0],A:[0,1,0,1,0,1,1,1,1,1,0,1,1,0,1],C:[1,1,1,1,0,0,1,0,0,1,0,0,1,1,1],E:[1,1,1,1,0,0,1,1,0,1,0,0,1,1,1],F:[1,1,1,1,0,0,1,1,0,1,0,0,1,0,0],O:[1,1,1,1,0,1,1,0,1,1,0,1,1,1,1],P:[1,1,1,1,0,1,1,1,1,1,0,0,1,0,0],R:[1,1,0,1,0,1,1,1,0,1,0,1,1,0,1],S:[1,1,1,1,0,0,1,1,0,0,0,1,1,1,1]},Cache:{}};
(function(e){var c=function(d){function b(a,b,c,g){void 0===c&&(c="");void 0===g&&(g={a:20,M:"white",N:e.Zb});d.call(this,a,b,0,0);this.Text=c;this.i=g;this.Oa(g.M);this.Aa(g.a)}m(b,d);b.prototype.Oa=function(a){this.ta=this.i.N.Cache[a]?this.i.N.Cache[a]:this.i.N.Cache[a]=new e.Kb(this.i.N,20,a)};b.prototype.Ba=function(a){this.Text=a;this.zb()};b.prototype.Aa=function(a){this.i.a=a;this.B=a/this.i.N.Z.Ia;this.W=this.i.N.Z.Ea*this.B;this.zb()};b.prototype.X=function(a){for(var b=this.i.a/this.ta.a,
d=0;d<this.Text.length;++d){var c=this.Text[d];" "!==c&&this.ta.cb(a,c,0,0,b);a.translate(this.W+this.B,0)}};b.prototype.zb=function(){this.a.x=(this.W+this.B)*this.Text.length-this.B;this.a.y=this.i.a};return b}(f.Ha);e.Text=c;c=function(d){function b(){d.apply(this,arguments)}m(b,d);b.prototype.D=function(a){var b=this.i.a/this.ta.a,d=this.b,c=d.x,d=d.y,c=c-this.a.x*this.v.x*this.g.x,d=d-this.a.y*this.v.y*this.g.y,h=a.globalAlpha;a.globalAlpha*=this.$;for(var e=0;e<this.Text.length;++e){var p=this.Text[e];
" "!==p&&this.ta.cb(a,p,c,d,b*this.g.x,b*this.g.y);c+=(this.W+this.B)*this.g.x}a.globalAlpha=h};return b}(c);e.na=c})(n||(n={}));(function(e){e.Ma=function(c,d){if(d<c)throw Error();return c+Math.random()*(d-c)}})(f||(f={}));
(function(e){var c=function(){function d(b,a,d,c){void 0===c&&(c=NaN);this.pa=b;this.ab=a;this.ra=d;this.Nb=c;this.aa=this.G=0}d.prototype.s=function(b){this.G+=b;this.G>this.ra&&(0===this.aa&&(this.pa.call(this.ab,b),this.aa+=1),this.G-this.ra>this.Nb*this.aa&&(this.pa.call(this.ab,b),this.aa+=1))};return d}();e.hc=c})(f||(f={}));var q,r=q||(q={});(r.V||(r.V={})).color={active:"white",Cb:"#E74C3C",mc:"#3498DB",background:"#2C3E50"};
(function(e){(function(c){var d=f.f,b=f.f.ma,a=function(a){function c(){a.apply(this,arguments);this.Da=d.m(0,0);this.j=[];this.M="red";this.u=1;this.ha=0;this.za=.2}m(c,a);c.prototype.s=function(a){1<this.j.length&&(this.M=1<this.c.wa?e.V.color.mc:e.V.color.active,this.Hb());d.J(this.Da,b);d.g(b,a);d.oa(this.b,b,this.b)};c.prototype.X=function(){throw Error("Unimplemented");};c.prototype.ua=function(){return 0<this.j.length};c.prototype.Xa=function(a){var c=this.j[this.j.length-1];if(c){if(d.ga(a,
c,b),a=d.Ja(b),20<a){d.wb(b);d.g(b,20);for(var l=d.J(b);20<a;)d.oa(c,l,b),this.j.push(c=d.J(b)),a-=20}}else this.j.push(d.J(a));this.M=e.V.color.active};c.prototype.Hb=function(){d.ga(this.j[0],this.b,b);5>d.Ja(b)&&(this.j.shift(),this.ha=0,this.za=.2,this.u+=this.c.wa);var a=d.Ya(b),c=d.Ya(this.Da),a=Math.atan2(Math.sin(a-c),Math.cos(a-c)),a=a*this.za;this.ha+=a;d.sb(this.Da,a);Math.abs(this.ha)>2*Math.PI&&(this.za*=2,this.ha=0)};return c}(f.Ha);c.Db=a})(e.Fa||(e.Fa={}))})(q||(q={}));
(function(e){(function(c){var d=function(b){function a(a,d,c,h){b.call(this,a,d,c,h);this.T=new n.Text(0,0);this.T.v.Set(.5,.5);this.T.b.Set(c/2,h/2)}m(a,b);a.prototype.s=function(a){this.da+=1*Math.PI*a;b.prototype.s.call(this,a)};a.prototype.X=function(a){a.globalCompositeOperation="xor";a.fillStyle=this.M;a.fillRect(0,0,this.a.x,this.a.y);this.T.Ba(this.u.toString());this.T.da=-this.da;this.T.D(a)};return a}(c.Db);c.$b=d})(e.Fa||(e.Fa={}))})(q||(q={}));
(function(e){var c=f.f,d={lc:0,Bb:!1},b=function(a){function b(){a.apply(this,arguments)}m(b,a);b.prototype.D=function(b){var d=b.globalCompositeOperation;b.globalCompositeOperation="xor";a.prototype.D.call(this,b);b.globalCompositeOperation=d};return b}(n.na),a=function(a){function b(){a.apply(this,arguments)}m(b,a);b.prototype.D=function(b){var d=b.globalCompositeOperation;b.globalCompositeOperation="destination-over";a.prototype.D.call(this,b);b.globalCompositeOperation=d};return b}(n.na),l=function(l){function g(b,
d){l.call(this,0,0,b,d);this.$a={dc:3,Sb:30};this.u=0;this.wa=1;this.ka=this.$a.Sb;this.o=new f.kc;this.ec=new f.hc(this.tb,this,0,this.$a.dc);this.la=new a(b/2,b/3);this.la.v.Set(.5,.5);this.la.Oa("#32465a");this.la.Aa(120)}m(g,l);g.prototype.s=function(a){this.ka-=a;this.o.s(a);0>this.ka?a/=30:this.la.Ba(this.ka.toFixed(0));this.ec.s(a);for(var b=0,c=this.ea;c&&c.c;c=c.h){c.s(a);if(c.ua())for(var b=b+1,e=c.h;e;e=e.h)e.ua()&&(this.Pb(c,e,d),d.Bb&&this.Wb(c,e));c.b.y<-c.a.y/2?this.nb(c):c.b.x>this.a.x||
0>c.b.x?this.nb(c):c.b.y>this.a.y&&this.Xb(c)}a=4>b?1:b/2|0;if(0!==this.wa-a)for(c=this.ea;c&&c.ua();c=c.h)this.o.m(c.g).L({x:1.5,y:1.5},.2,f.Wa.ob).Ta().L({x:1,y:1},.2).U();this.wa=a};g.prototype.Eb=function(a){this.fa?(this.fa.h=a,a.H=this.fa,this.fa=a):this.ea=this.fa=a;a.c=this};g.prototype.Na=function(a){a.h?a.H?(a.H.h=a.h,a.h.H=a.H):(a.h.H=null,this.ea=a.h):a.H?(a.H.h=null,this.fa=a.H):this.ea=this.fa=null;a.c=void 0};g.prototype.Lb=function(a){for(var b=this.ea;b;b=b.h)if(b.Qb(a))return b;
return null};g.prototype.fb=function(a){if(!(2>a.j.length)){var b=a.j[a.j.length-1],d=c.ma;c.ga(b,a.j[a.j.length-2],d);c.g(d,20);c.oa(b,d,d);a.Xa(d)}};g.prototype.X=function(a){a.strokeStyle=e.V.color.active;a.setLineDash([3,9]);a.lineWidth=2;for(var b=this.ea;b;b=b.h)if(b.ua()){a.beginPath();a.moveTo(b.b.x,b.b.y);for(var c=0,d=b.j;c<d.length;c++){var g=d[c];a.lineTo(g.x,g.y)}a.stroke()}l.prototype.X.call(this,a);this.la.D(a)};g.prototype.Pb=function(a,b,d){var e=c.ma;c.ga(a.b,b.b,e);d.Bb=(d.lc=c.Ja(e))<
(a.a.x+b.a.x)/2};g.prototype.nb=function(a){var b=Math.min(-a.u,-10);this.u+=b;a.b.y+=a.a.y/2;this.bb(a.b,b);this.Na(a);this.ya(a);this.tb()};g.prototype.Xb=function(a){this.u+=a.u;this.bb(a.b,a.u);this.Na(a);this.ya(a)};g.prototype.Wb=function(){for(var a=this,b=[],d=0;d<arguments.length;d++)b[d-0]=arguments[d];b.forEach(function(b){a.Na(b);a.o.m(b).L({$:0},2).yb(function(){return b.qb()}).U()})};g.prototype.tb=function(){var a=new e.Fa.$b(f.Ma(15,this.a.x-15),this.a.y-5,30,30);a.M=e.V.color.Cb;
a.v.Set(.5,.5);a.$=0;a.g.Set(.1,.1);var b=c.ma;b.y=0;b.x=f.Ma(15,this.a.x-15);c.ga(a.b,b,b);c.wb(b);c.g(b,f.Ma(-80,-60));c.J(b,a.Da);this.o.m(a).L({$:1},.2).U();this.o.m(a.g).L({x:1,y:1},.2).U();this.Eb(a);this.Y(a)};g.prototype.bb=function(a,d){var c=new b(a.x,a.y,(0<d?"+":"")+d);c.v.Set(.5,.5);c.Oa(0<d?e.V.color.active:e.V.color.Cb);this.Y(c);var l=0<d?2:1;this.o.m(c.g).L({x:l,y:l},.5,f.Wa.ob).ra(.3).Ta(c).L({$:0},.3).yb(function(){c.qb()}).U();if(0>a.x||a.x>this.a.x){var g=0<a.x?1:-1;this.o.m(c.b).L({x:a.x-
g*c.a.x*l},.2).U()}else g=0<a.y?1:-1,this.o.m(c.b).L({y:a.y-g*c.a.y*l},.2).U()};return g}(f.ib);e.c=l})(q||(q={}));
(function(e){var c=function(){function b(a,b){this.Sa=a;this.ja=b;this.G=0;this.va=!1}b.prototype.U=function(){var a=this.gb();a.ja&&a.ja.fc(a);if(a.va)for(;a;)a.va=!1,a.G=0,a=a.h};b.prototype.L=function(a,b,c){void 0===b&&(b=1);void 0===c&&(c=d.Tb);this.Ua=[];for(var e in a)this.Ua.push({key:e,start:0,Ab:0,end:a[e]});this.eb=b;this.Jb=c;return this};b.prototype.yb=function(a){this.kb=a;return this};b.prototype.Ta=function(a){void 0===a&&(a=this.Sa);this.h=a=new b(a,this.ja);a.H=this;return a};b.prototype.ra=
function(a){return this.Ta().L({},a)};b.prototype.s=function(a){for(var b=this;b;)if(0===b.G&&b.Mb(),b.G+=a,b.G<=b.eb){b.xb();break}else b.va||(b.xb(),b.kb&&b.kb(),b.ja&&!b.h&&b.ja.gc(b.gb()),b.va=!0),b=b.h};b.prototype.gb=function(){for(var a=this;a.H;)a=a.H;return a};b.prototype.xb=function(){for(var a=0,b=this.Ua;a<b.length;a++){var c=b[a];this.Sa[c.key]=this.Jb(this.G,c.start,c.Ab,this.eb)}};b.prototype.Mb=function(){for(var a=0,b=this.Ua;a<b.length;a++){var c=b[a];c.start=this.Sa[c.key];c.Ab=
c.end-c.start}};return b}();e.jc=c;var d;(function(b){b.Tb=function(a,b,c,d){return c*a/d+b};b.ob=function(a,b,c,d){a/=d;a--;return c*(a*a*a+1)+b}})(d=e.Wa||(e.Wa={}));c=function(){function b(){this.o=[]}b.prototype.m=function(a){return new e.jc(a,this)};b.prototype.fc=function(a){this.o.push(a)};b.prototype.gc=function(a){a=this.o.indexOf(a);if(0<=a)this.o.splice(a,1);else throw Error();};b.prototype.s=function(a){for(var b=0,c=this.o;b<c.length;b++)c[b].s(a)};return b}();e.kc=c})(f||(f={}));
var t=function(){function e(c,d){this.l=c;this.pa=d;this.Ub=this.xa.bind(this);window.addEventListener("resize",this.Ub)}e.prototype.xa=function(){var c=this.l.w.width=window.innerWidth,d=this.l.w.height=window.innerHeight;this.pa(c,d)};return e}(),k=function(){function e(){this.ia=new n.pb(0,0,10,10,{fillStyle:"red"});this.Gb=50}e.prototype.U=function(c){document.body.style.background=q.V.color.background;this.l=c;this.K=new f.ib(0,0,c.w.width,c.w.height);this.K.b.Set(.5,.5);this.c=new q.c(320,350);
this.K.Y(this.c);var d=new f.Vb(c);d.Qa(this.lb,this);d.Pa(this.La,this);d.Ra(this.mb,this);d=new f.ic(c);d.Qa(this.lb,this);d.Pa(this.La,this);d.Ra(this.mb,this);this.K.Y(new n.pb(0,this.c.a.y,this.c.a.x,this.Gb,{fillStyle:"rgba(0, 0, 0, 0.5)"}));this.T=new n.na(5.5,this.c.a.y+5.5);this.T.Aa(10);this.K.Y(this.T);this.sa=new n.na(this.c.a.x-5.5,this.c.a.y+5.5);this.sa.v.Set(1,0);this.sa.Aa(10);this.K.Y(this.sa);this.cc=new t(c,this.xa.bind(this));this.cc.xa()};e.prototype.lb=function(c,d){this.ia.b.Set(c,
d);this.I||this.La(c,d);var b=this.c.Ca(this.ia.b);this.I&&(0>b.y||b.y>this.c.a.y||0>b.x||b.x>this.c.a.y)&&(this.c.fb(this.I),this.I=void 0)};e.prototype.La=function(c,d){this.ia.b.Set(c,d);var b=this.c.Lb(this.ia.b);b&&(b.j=[],this.I=b)};e.prototype.mb=function(){this.I?(this.c.fb(this.I),this.I=void 0):0>this.c.ka&&(this.K.ya(this.c),this.c=new q.c(320,350),this.K.Y(this.c))};e.prototype.s=function(c){this.c.s(c);if(this.I){if(!this.I.ca){this.I=void 0;return}this.I.Xa(this.c.Ca(this.ia.b))}this.sa.Ba("FPS "+
(1E3*c).toFixed(1));this.T.Ba("SCORE: "+this.c.u)};e.prototype.D=function(c){c.clearRect(0,0,c.canvas.width,c.canvas.height);this.K.D(c)};e.prototype.xa=function(c,d){this.K.a.Set(c,d);var b=Math.min(c/this.c.a.x,d/(this.c.a.y+20));this.K.g.Set(b,b);console.log("new size ",c,d)};return e}(),u=new f.l("canvas");u.Fb();u.Play("demo");
